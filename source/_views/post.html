{% extends "blog" %}

{% block content_wrapper %}
<main class="max-w-notion mx-auto px-4 pb-12">
    <article>
        <!-- Notion-style post header -->
        <header class="mb-8 pt-4">
            <h1 class="text-notion-text mb-3">
                <a class="no-underline text-inherit hover:text-inherit" href="{{ page.url }}">{{ page.title | raw }}</a>
            </h1>

            <!-- Date and tags in muted secondary text -->
            <div class="flex flex-wrap items-center gap-2 text-sm text-notion-text-secondary">
                <time datetime="{{ page.date|date('Y-m-d') }}">{{ page.date|date('F j, Y') }}</time>

                {% if page.tags is defined and page.tags|length > 0 %}
                <span class="text-notion-border">·</span>
                {% for tag in page.tags %}
                <a href="{{ site.url }}/blog/tag/{{ tag|url_encode(true) }}" class="notion-tag">
                    {{ constant('App\\Blog\\Tag::ALLOWED_TAGS')[tag] ?? tag }}
                </a>
                {% endfor %}
                {% endif %}
            </div>
        </header>

        <!-- Content -->
        <section class="notion-content">
            {{ page.blocks.content|raw }}
        </section>

        <!-- Notion-style previous/next navigation -->
        <div class="border-t border-notion-border pt-8 mt-12">
            {% if page.previous_post or page.next_post %}
            <nav class="flex flex-col sm:flex-row gap-3">
                {% if page.previous_post %}
                <a href="{{ site.url }}{{ page.previous_post.url }}" class="notion-nav-link flex-1">
                    <span class="notion-nav-label">← Previous</span>
                    <span class="notion-nav-title">{{ page.previous_post.title }}</span>
                </a>
                {% endif %}

                {% if page.next_post %}
                <a href="{{ site.url }}{{ page.next_post.url }}" class="notion-nav-link flex-1 sm:text-right">
                    <span class="notion-nav-label">Next →</span>
                    <span class="notion-nav-title">{{ page.next_post.title }}</span>
                </a>
                {% endif %}
            </nav>
            {% endif %}
        </div>
    </article>
</main>
{% endblock %}

{% block head_scripts %}
<script src="//cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const anchors = new AnchorJS()
    anchors.add()

    for (const element of document.getElementsByClassName('anchorjs-link')) {
      element.addEventListener('click', function () {
        navigator.clipboard.writeText(window.location.origin + window.location.pathname + element.getAttribute('href'))
      })
    }
  })
</script>
{% endblock %}
